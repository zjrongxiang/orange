## 节点管理插件（node插件）

### 使用说明
orange 网关具有集群功能。在集群部署模式下，一台网关应用服务器调整配置，需要及时手动同步配置到数据库持久化，另外其他网关节点需要手动同步将数据库中最新配置加载至网关内存。

node插件就是为了一键式将配置信息同步至集群中其他节点的管理类插件。 用于同步每个节点的配置信息，注意，节点上的 upstream 仍然需要手动维护 (/usr/local/orange/nginx.conf)

### 使用前提

1. 在 `orange.conf` 中添加 `node` 插件配置
2. 需要在数据库初始化组件需要的表
2. 在 `orange.conf` 保证 dashboard auth 为开启状态，否则看不到节点管理
3. 打开 dashboard 页面，在左侧找到节点管理。
4. 各个节点的`orange.conf` 中的数据库配置要相同。

### 初始化节点

1. 选择一台安装了orange的服务器作为主节点(这个主从的概念是自己建立的)，访问主节点上的orange，在节点管理页面上选择注册节点
2. 然后选择添加“添加节点”，输入其他机器的IP地址等信息，端口通常固定为 7777 ，api访问账号密码设置为之前 `orange.conf` 中的数值。

### 添加节点

1. 访问主节点机器的 orange 页面，找到 节点管理
2. 选择顶部的添加节点，输入名称、IP地址、端口、api_username、api_password，其中 api 用户名和密码是在 `orange.conf` 中的配置

### 同步节点数据

1. 先访问主节点的dashboard页面，然后修改配置
2. 修改完之后，选择左侧的节点管理，然后选择右上角的“同步orange节点“按钮，就可以将配置同步到其他节点上。
